# =============================================================================
# ChiroERP - Gradle Build Configuration
# =============================================================================
# This file contains global Gradle settings that apply to the entire project.
# Settings here affect build performance, dependency resolution, and JVM config.
#
# Reference: BUILD_SYSTEM_UPDATE.md (from erp-platform)
# =============================================================================

# -----------------------------------------------------------------------------
# Project Metadata
# -----------------------------------------------------------------------------
group=com.chiroerp
version=1.0.0-SNAPSHOT

# -----------------------------------------------------------------------------
# Gradle Build Performance
# -----------------------------------------------------------------------------
# Enable parallel project execution (multiple modules build concurrently)
org.gradle.parallel=true

# Number of parallel workers (defaults to number of CPU cores)
# Adjust based on your system: org.gradle.workers.max=4
org.gradle.workers.max=4

# Enable Gradle build cache (dramatically speeds up rebuilds)
org.gradle.caching=true

# Enable configuration cache (experimental but significant performance gain)
# Caches the result of the configuration phase
org.gradle.configuration-cache=true

# Enable file system watching (faster incremental builds)
org.gradle.vfs.watch=true

# Gradle daemon (enabled by default, disable in CI with --no-daemon flag)
org.gradle.daemon=true

# Configure build on demand (only build changed modules)
# Disabled for multi-project builds to ensure consistency
org.gradle.configureondemand=false

# -----------------------------------------------------------------------------
# JVM Configuration for Gradle Daemon
# -----------------------------------------------------------------------------
# Increase heap size for large multi-project builds (92 modules)
org.gradle.jvmargs=-Xms1g -Xmx4g -XX:MaxMetaspaceSize=1g -XX:+HeapDumpOnOutOfMemoryError

# Enable JVM optimizations
org.gradle.jvmargs=-Xms1g -Xmx4g -XX:MaxMetaspaceSize=1g \
    -XX:+UseG1GC \
    -XX:+ParallelRefProcEnabled \
    -XX:MaxGCPauseMillis=200 \
    -Dfile.encoding=UTF-8 \
    -Duser.country=US \
    -Duser.language=en

# -----------------------------------------------------------------------------
# Kotlin Configuration
# -----------------------------------------------------------------------------
# Enable incremental compilation for Kotlin
kotlin.incremental=true

# Use K2 compiler (new Kotlin compiler - faster compilation)
# kotlin.experimental.tryK2=true

# Enable Kotlin compiler daemon
# Temporarily disabled due to CreateProcess error=1920 on Windows
# kotlin.compiler.execution.strategy=daemon
kotlin.compiler.execution.strategy=in-process

# Kotlin compiler arguments caching
kotlin.compiler.incremental.cache.enabled=true

# -----------------------------------------------------------------------------
# Java Toolchain
# -----------------------------------------------------------------------------
# Java 21 is required for ChiroERP (Quarkus 3.29.0 + modern Kotlin)
# Gradle will automatically download JDK 21 if not found
org.gradle.java.installations.auto-detect=true
org.gradle.java.installations.auto-download=true

# -----------------------------------------------------------------------------
# Dependency Resolution
# -----------------------------------------------------------------------------
# Enable dependency locking for reproducible builds
# org.gradle.dependency.verification=lenient

# Enable Gradle Module Metadata
org.gradle.dependency.resolution.module-metadata=true

# -----------------------------------------------------------------------------
# Console Output
# -----------------------------------------------------------------------------
# Rich console output (colors, progress indicators)
org.gradle.console=auto

# Show warnings during build
org.gradle.warning.mode=all

# -----------------------------------------------------------------------------
# Build Logging
# -----------------------------------------------------------------------------
# Log level: quiet, warn, lifecycle (default), info, debug
org.gradle.logging.level=lifecycle

# -----------------------------------------------------------------------------
# Quarkus Configuration
# -----------------------------------------------------------------------------
# Quarkus dev mode configuration
quarkus.analytics.disabled=true
quarkus.banner.enabled=true

# Quarkus native build configuration (requires GraalVM)
# quarkus.native.container-build=true
# quarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21

# -----------------------------------------------------------------------------
# Test Execution
# -----------------------------------------------------------------------------
# Show test output in console
org.gradle.testoutput=true

# -----------------------------------------------------------------------------
# Build Scan (Optional - Requires Gradle Enterprise)
# -----------------------------------------------------------------------------
# Enable build scans for detailed build analysis
# Uncomment to enable:
# org.gradle.scan.server=https://ge.chiroerp.com
# org.gradle.scan.termsOfServiceUrl=https://gradle.com/terms-of-service
# org.gradle.scan.termsOfServiceAgree=yes

# -----------------------------------------------------------------------------
# CI/CD Specific Settings
# -----------------------------------------------------------------------------
# These are typically set via environment variables in CI, not here:
# - CI=true
# - org.gradle.daemon=false (disable daemon in CI)
# - org.gradle.parallel=false (optional, for deterministic CI builds)
# - org.gradle.caching=true (use remote cache in CI)
# - org.gradle.build-cache.remote.url=https://cache.chiroerp.com/cache/

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# Enable strict dependency verification (optional)
# org.gradle.dependency.verification=strict

# -----------------------------------------------------------------------------
# Developer Experience
# -----------------------------------------------------------------------------
# Welcome message
systemProp.chiroerp.welcome=true

# Show module discovery log
systemProp.chiroerp.verbose.discovery=true

# -----------------------------------------------------------------------------
# Architecture Rules (ADR Compliance)
# -----------------------------------------------------------------------------
# Enable architecture validation during build
chiroerp.architecture.validation=true

# Fail build on architecture violations (ADR-001, ADR-002, ADR-006)
chiroerp.architecture.failOnViolation=false

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
# Enable experimental features
chiroerp.feature.nativeImage=false
chiroerp.feature.graalvm=false

# -----------------------------------------------------------------------------
# Local Development Overrides
# -----------------------------------------------------------------------------
# Developers can create gradle-local.properties (gitignored) to override
# settings without affecting team members. Example:
#   org.gradle.workers.max=8
#   org.gradle.jvmargs=-Xmx8g
